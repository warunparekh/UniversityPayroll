@model List<UniversityPayroll.Models.SalaryStructure>
@using System.Text.Json;
@{
    ViewData["Title"] = "Salary Structures";
}

<div id="react-root"></div>

<script>
    const salaryStructuresData = @Html.Raw(Json.Serialize(Model));
</script>

<script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

<script>
    const e = React.createElement;

    const SalaryStructureTable = ({ structures }) => {
        return e('div', null,
            e('h2', null, 'Salary Structures'),
            e('p', null, 
                e('a', { href: "/SalaryStructure/Create", className: "btn btn-primary" }, 'New Structure')
            ),
            e('table', { className: "table table-striped" },
                e('thead', null,
                    e('tr', null, 
                        e('th', null, 'Designation'),
                        e('th', null, 'DA %'),
                        e('th', null, 'HRA %'),
                        e('th', null, 'Increment %'),
                        e('th', null, 'PF Emp %'),
                        e('th', null, 'PF Empr %'),
                        e('th', null, 'EDLI %'),
                        e('th', null, 'Actions')
                    )
                ),
                e('tbody', null,
                    structures.map(s => 
                        e('tr', { key: s.id },
                            e('td', null, s.designation),
                            e('td', null, s.allowances ? s.allowances.daPercent : 0),
                            e('td', null, s.allowances ? s.allowances.hraPercent : 0),
                            e('td', null, s.annualIncrementPercent),
                            e('td', null, s.pf ? s.pf.employeePercent : 0),
                            e('td', null, s.pf ? s.pf.employerPercent : 0),
                            e('td', null, s.pf ? s.pf.edliPercent : 0),
                            e('td', null,
                                e('a', { href: `/SalaryStructure/Edit/${s.id}`, className: "btn btn-sm btn-secondary" }, 'Edit'),
                                e('form', { action: `/SalaryStructure/Delete/${s.id}`, method: 'post', style: { display: 'inline' }, onSubmit: (ev) => { if (!confirm('Delete this structure?')) ev.preventDefault(); } },
                                    e('button', { type: 'submit', className: "btn btn-sm btn-danger", style: { marginLeft: '5px' } }, 'Delete')
                                )
                            )
                        )
                    )
                )
            )
        );
    };

    const container = document.getElementById('react-root');
    const root = ReactDOM.createRoot(container);
    root.render(e(SalaryStructureTable, { structures: salaryStructuresData }));
</script>
